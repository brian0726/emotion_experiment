# 감정 인식 실험 프로그램

감정 인식 실험을 위한 Streamlit 기반 웹 애플리케이션입니다.

## 프로젝트 개요

참가자들이 이미지, 동영상, 맥락 정보를 보고 23개의 감정(기본 8개 + 복합 15개) 중 가장 적합한 감정을 선택하는 실험 프로그램입니다.

## 주요 기능

### 메인 실험
- **3가지 실험 타입** (순서대로 진행)
  - **실험 1**: 이미지 제시 → 정서 선택 (23문항)
  - **실험 2**: 동영상 제시 → 정서 선택 (23문항)
  - **실험 3**: 맥락 정보 포함 동영상 제시 → 정서 선택 (23문항)

### 자극 제시 방식
- 자극 5초간 제시 후 사라짐
- 선지 7개 랜덤 제시
- 응답 시간 총 10초
  - 5초 후: "빠르게 응답해 주세요" 프롬프트 표시
  - 10초 후: 자동으로 다음 문항으로 이동

### 실험 진행
- 각 파트별 연습 시행 (반복 가능)
- 본 실험 23문항 (무작위 순서)
- 중간 휴식 시간 (30초, 약 12번째 문항 후)
- 실시간 진행률 및 타이머 표시

### 감정 리스트 (23개)
**기본 정서 (8개)**
- 기쁨, 분노, 혐오, 중립, 즐거운, 슬픔, 놀람, 공포

**복합 정서 (15개)**
- 애절하는, 실망하는, 공감하는, 힘들어하는, 사랑하는
- 초조한, 안심하는, 우울한, 불안한, 씁쓸한
- 활기찬, 쑥스러운, 진지한, 창피한, 쌀쌀맞은

### 데이터 수집
- **참가자 정보**
  - 이름, 성별, 생년월일
  - DRC 코드 (4-5자리 숫자 아이디)
  - 학번

- **응답 데이터**
  - 각 문항별 응답 시간 측정
  - 정답/오답 여부 기록
  - 연습/본 시행 구분
  - CSV 형식으로 자동 저장 및 다운로드

### 설문조사 (4종)

#### 1. 일반 설문
- 감정 인식 능력 자가 평가
- 실험 난이도 평가
- 자유 의견

#### 2. 피로도 설문 (MFI - Multidimensional Fatigue Inventory)
- 12문항
- 5점 척도 (1: 전혀 그렇지 않다 ~ 5: 매우 그렇다)
- 신체적/정신적 피로도 측정

#### 3. 우울 설문 (PHQ-9 - Patient Health Questionnaire)
- 9문항
- 4점 척도 (0: 전혀 아님 ~ 3: 거의 매일)
- 우울 심각도 자동 계산 및 피드백
- 위기 상담 안내 포함

#### 4. 성격 설문 (TIPI - Ten-Item Personality Inventory)
- 10문항
- 7점 척도 (1: 전혀 동의하지 않는다 ~ 7: 매우 동의한다)
- Big Five 성격 특성 측정 및 시각화
  - 외향성, 우호성, 성실성, 정서적 안정성, 개방성

## 설치 및 실행

### 로컬 실행

```bash
# 저장소 클론
git clone https://github.com/brian0726/emotion_experiment.git
cd emotion_experiment

# 가상환경 생성 (선택사항)
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 패키지 설치
pip install -r requirements.txt

# 앱 실행
streamlit run app.py
```

브라우저가 자동으로 열리며 `http://localhost:8501`에서 앱이 실행됩니다.

### GitHub를 통한 배포

#### Streamlit Cloud 사용

1. GitHub에 저장소 푸시
2. [Streamlit Cloud](https://streamlit.io/cloud)에 접속
3. "New app" 클릭
4. 저장소 선택 및 배포

## 프로젝트 구조

```
emotion_experiment/
├── app.py                    # 메인 실험 앱
├── surveys.py                # 설문조사 모듈
├── data/                     # 데이터 저장 디렉토리 (자동 생성)
├── requirements.txt          # 패키지 의존성
├── .gitignore               # Git 제외 파일
└── README.md                # 프로젝트 설명
```

## 데이터 저장

실험 결과는 `data/` 디렉토리에 CSV 형식으로 저장됩니다.

### 파일 구조
```
data/
├── response_학번_날짜_시간.csv      # 실험 응답 데이터
├── survey_이름_날짜_시간.csv        # 일반 설문 데이터
├── mfi_학번_날짜_시간.csv           # 피로도 설문 데이터
├── phq9_학번_날짜_시간.csv          # 우울 설문 데이터
└── tipi_학번_날짜_시간.csv          # 성격 설문 데이터
```

### 응답 데이터 컬럼
- `trial_number`: 문항 번호 (1-23)
- `experiment_type`: 실험 타입 (1: 이미지, 2: 동영상, 3: 맥락)
- `correct_emotion`: 정답 감정
- `selected_emotion`: 선택한 감정
- `is_correct`: 정답 여부 (True/False)
- `reaction_time`: 반응 시간 (초)
- `is_practice`: 연습 시행 여부
- `name`, `gender`, `birthdate`, `drc_code`, `student_id`: 참가자 정보
- `timestamp`: 기록 시각

## 미디어 파일 설정

실험 자극 파일은 Google Drive에 저장되어 있습니다:

- **이미지**: 각 감정당 10개씩
- **동영상**: 각 감정당 3개씩
- **맥락**: 각 감정당 3개씩

### 설정 방법
1. Google Drive에 미디어 파일 업로드
2. 공유 설정: "링크가 있는 모든 사용자"
3. `app.py`의 `MEDIA_FILES` 딕셔너리에 파일 ID 추가

```python
MEDIA_FILES = {
    "기쁨": {
        "image": ["FILE_ID_1", "FILE_ID_2", ...],  # 10개
        "video": ["FILE_ID_1", "FILE_ID_2", ...],  # 3개
        "context": ["FILE_ID_1", "FILE_ID_2", ...] # 3개
    },
    # ... 다른 감정들
}
```

## 특수 기능

### 스킵 기능
특정 학번(2023321063)으로 로그인 시 본 실험에서 문항 스킵 기능 활성화

### 자동 타이머
- 자극 제시: 5초 후 자동으로 사라짐
- 프롬프트: 5초 후 "빠르게 응답해 주세요" 표시
- 자동 진행: 10초 후 다음 문항으로 자동 이동

## 실험 결과 분석

각 설문은 다음과 같은 분석 결과를 제공합니다:

### PHQ-9 우울 설문
- 총점 계산 (0-27점)
- 심각도 평가 (최소/경미/중간/중증도/심각)
- 위기 상황 감지 및 상담 안내

### TIPI 성격 설문
- Big Five 차원별 점수 계산
- 시각적 프로필 제공
- 각 특성별 설명 제공

## 주의사항

1. **Google Drive 파일 설정**: 모든 미디어 파일의 공유 설정을 "링크가 있는 모든 사용자"로 설정해야 합니다.

2. **개인정보 보호**: `data/` 디렉토리는 `.gitignore`에 포함되어 GitHub에 업로드되지 않습니다.

3. **타이머 정확도**: Streamlit의 제한으로 인해 타이머가 정확히 5초/10초가 아닐 수 있습니다. 중요한 연구에서는 추가 검증이 필요합니다.

4. **윤리적 고려사항**: PHQ-9 설문에서 자해/자살 생각이 감지되면 즉시 전문가 상담 정보를 제공합니다.

## 기술 스택

- **프레임워크**: Streamlit 1.29.0
- **데이터 처리**: Pandas 2.1.3
- **언어**: Python 3.8+
- **데이터 저장**: CSV
- **배포**: Streamlit Cloud / GitHub

## 라이선스

이 프로젝트는 연구 목적으로 사용됩니다.

## 문의

실험 관련 문의사항은 연구팀에 연락해 주세요.

---

**개발 정보**
- 원본: Google Apps Script 기반 실험을 Streamlit으로 전환
- 마지막 업데이트: 2025-11-27